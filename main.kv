ScreenManager:
    WelcomeScreen:
        name: "welcome"
    HomeScreen:
        name: "home"
    PresetsScreen:
        name: "presets"
    PresetDetailScreen:
        name: "preset_detail"
    ExerciseLibraryScreen:
        name: "exercise_library"
    ProgressScreen:
        name: "progress"
    WorkoutHistoryScreen:
        name: "workout_history"
    SettingsScreen:
        name: "settings"
    RestScreen:
        name: "rest"
    WorkoutActiveScreen:
        name: "workout_active"
    MetricInputScreen:
        name: "metric_input"
    WorkoutEditScreen:
        name: "workout_edit"
    WorkoutSettingsScreen:
        name: "workout_settings"
    WorkoutSummaryScreen:
        name: "workout_summary"
    EditPresetScreen:
        name: "edit_preset"
    PresetOverviewScreen:
        name: "preset_overview"

<HomeScreen@MDScreen>:
    BoxLayout:
        orientation: "vertical"
        spacing: "10dp"
        padding: "20dp"
        MDLabel:
            text: "HomeScreen"
            halign: "center"
        MDRaisedButton:
            text: "Go to Presets"
            on_release: app.root.current = "presets"
        MDRaisedButton:
            text: "Go to Progress"
            on_release: app.root.current = "progress"
        MDRaisedButton:
            text: "Go to Settings"
            on_release: app.root.current = "settings"
        MDRaisedButton:
            text: "Go to Workout History"
            on_release: app.root.current = "workout_history"

<PresetsScreen>:
    BoxLayout:
        orientation: "vertical"
        spacing: "10dp"
        padding: "20dp"
        MDLabel:
            text: "PresetsScreen"
            halign: "center"
        ScrollView:
            MDList:
                OneLineListItem:
                    id: preset_push
                    text: "Push"
                    on_release: root.select_preset("Push", self)
                OneLineListItem:
                    id: preset_pull
                    text: "Pull"
                    on_release: root.select_preset("Pull", self)
                OneLineListItem:
                    id: preset_legs
                    text: "Legs"
                    on_release: root.select_preset("Legs", self)
        MDLabel:
            text: "Selected: " + root.selected_preset if root.selected_preset else "Select a preset"
            halign: "center"
        MDRaisedButton:
            text: "Select Preset"
            disabled: not root.selected_preset
            on_release: root.confirm_selection()
        MDRaisedButton:
            text: "Edit Preset"
            disabled: not root.selected_preset
            on_release: app.root.current = "edit_preset"
        MDRaisedButton:
            text: "New Preset"
            on_release: app.root.current = "edit_preset"
        MDRaisedButton:
            text: "Back to Home"
            on_release: app.root.current = "home"

<PresetDetailScreen@MDScreen>:
    BoxLayout:
        orientation: "vertical"
        spacing: "10dp"
        padding: "20dp"
        MDLabel:
            text: root.preset_name if root.preset_name else "PresetDetailScreen"
            halign: "center"
        MDRaisedButton:
            text: "Go to Preset Overview"
            on_release: app.root.current = "preset_overview"
        MDRaisedButton:
            text: "Back to Presets"
            on_release: app.root.current = "presets"

<ExerciseLibraryScreen@MDScreen>:
    BoxLayout:
        orientation: "vertical"
        spacing: "10dp"
        padding: "20dp"
        MDLabel:
            text: "ExerciseLibraryScreen"
            halign: "center"
        MDRaisedButton:
            text: "Back"
            on_release: root.go_back()

<ProgressScreen@MDScreen>:
    BoxLayout:
        orientation: "vertical"
        spacing: "10dp"
        padding: "20dp"
        MDLabel:
            text: "ProgressScreen"
            halign: "center"
        MDRaisedButton:
            text: "Back to Home"
            on_release: app.root.current = "home"

<WorkoutHistoryScreen@MDScreen>:
    BoxLayout:
        orientation: "vertical"
        spacing: "10dp"
        padding: "20dp"
        MDLabel:
            text: "WorkoutHistoryScreen"
            halign: "center"
        MDRaisedButton:
            text: "Back to Home"
            on_release: app.root.current = "home"

<SettingsScreen@MDScreen>:
    BoxLayout:
        orientation: "vertical"
        spacing: "10dp"
        padding: "20dp"
        MDLabel:
            text: "SettingsScreen"
            halign: "center"
        MDRaisedButton:
            text: "Back to Home"
            on_release: app.root.current = "home"

<RestScreen>:
    BoxLayout:
        orientation: "vertical"
        spacing: "10dp"
        padding: "20dp"
        BoxLayout:
            orientation: "horizontal"
            size_hint_y: None
            height: self.minimum_height
            MDIconButton:
                icon: "minus"
                on_release: root.adjust_timer(-10)
            MDLabel:
                id: timer_label
                text: root.timer_label
                halign: "center"
                font_style: "H4"
            MDIconButton:
                icon: "plus"
                on_release: root.adjust_timer(10)
        MDLabel:
            text: "Next: " + root.next_exercise_name if root.next_exercise_name else ""
            halign: "center"
        Widget:
            size_hint_y: None
            height: "20dp"
        MDRaisedButton:
            text: "Record Metrics"
            on_release: app.root.current = "metric_input"
        MDRaisedButton:
            text: "Edit Workout"
            on_release: app.root.current = "workout_edit"
        MDRaisedButton:
            text: "Workout Settings"
            on_release: app.root.current = "workout_settings"
        MDRaisedButton:
            text: "Finish Workout"
            on_release: app.root.current = "workout_summary"

<WorkoutActiveScreen>:
    on_leave: root.stop_timer()
    BoxLayout:
        orientation: "vertical"
        spacing: "10dp"
        padding: "20dp"
        MDLabel:
            id: stopwatch
            text: root.formatted_time
            halign: "center"
            font_style: "H2"
        MDLabel:
            text: root.exercise_name
            halign: "center"
        MDRaisedButton:
            text: "End Set"
            on_release: app.root.current = "metric_input"

<MetricInputScreen>:
    on_pre_enter: root.populate_metrics()
    metric_list: metric_list
    BoxLayout:
        orientation: "vertical"
        spacing: "10dp"
        padding: "20dp"
        MDLabel:
            text: "MetricInputScreen"
            halign: "center"
        ScrollView:
            MDList:
                id: metric_list
        MDRaisedButton:
            text: "Save Metrics"
            on_release: root.save_metrics()

<WorkoutEditScreen@MDScreen>:
    BoxLayout:
        orientation: "vertical"
        spacing: "10dp"
        padding: "20dp"
        MDLabel:
            text: "WorkoutEditScreen"
            halign: "center"
        MDRaisedButton:
            text: "Back to Rest"
            on_release: app.root.current = "rest"

<WorkoutSettingsScreen@MDScreen>:
    BoxLayout:
        orientation: "vertical"
        spacing: "10dp"
        padding: "20dp"
        MDLabel:
            text: "WorkoutSettingsScreen"
            halign: "center"
        MDRaisedButton:
            text: "Back to Rest"
            on_release: app.root.current = "rest"

<WorkoutSummaryScreen>:
    summary_list: summary_list
    BoxLayout:
        orientation: "vertical"
        spacing: "10dp"
        padding: "20dp"
        ScrollView:
            MDList:
                id: summary_list
        MDRaisedButton:
            text: "Back to Home"
            on_release: app.root.current = "home"

<WelcomeScreen@MDScreen>:
    BoxLayout:
        orientation: "vertical"
        spacing: "10dp"
        padding: "20dp"
        MDLabel:
            text: "WelcomeScreen"
            halign: "center"
        MDRaisedButton:
            text: "Enter"
            on_release: app.root.current = "home"

<EditPresetScreen@MDScreen>:
    BoxLayout:
        orientation: "vertical"
        spacing: "10dp"
        padding: "20dp"
        MDLabel:
            text: "EditPresetScreen"
            halign: "center"
        MDRaisedButton:
            text: "Open Exercise Library"
            on_release:
                app.root.get_screen('exercise_library').previous_screen = 'edit_preset'
                app.root.current = 'exercise_library'
        MDRaisedButton:
            text: "Back to Presets"
            on_release: app.root.current = "presets"

<PresetOverviewScreen>:
    BoxLayout:
        orientation: "vertical"
        spacing: "10dp"
        padding: "20dp"
        MDLabel:
            text: "PresetOverviewScreen"
            halign: "center"
        MDRaisedButton:
            text: "Back to Detail"
            on_release: app.root.current = "preset_detail"
        MDRaisedButton:
            text: "Start Workout"
            on_release: root.start_workout()

